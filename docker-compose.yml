services:
  app:
    build:
      context: .                # repo root with your Dockerfile
      dockerfile: Dockerfile
    container_name: verisys-app
    environment:
      ASPNETCORE_ENVIRONMENT: Development
      ASPNETCORE_URLS: 'http://+:8080'
      # SINGLE-QUOTED to prevent $ interpolation
      ConnectionStrings__Postgres: 'Host=viresysdb.postgres.database.azure.com;Port=5432;Database=verisysdb;Username=waliprotick;Password=Helloworld123$;Ssl Mode=VerifyFull'
    ports:
      - '8080:8080'
    restart: unless-stopped

  frontend:
    build:
      context: ./web/verisys-web
      dockerfile: Dockerfile
    container_name: verisys-frontend
    depends_on:
      - app
    environment:
      # only needed if your frontend reads VITE_API_URL; otherwise rely on Vite proxy
      VITE_API_URL: 'http://app:8080'
    ports:
      - '5173:5173'
    command: ['npm','run','dev','--','--host','0.0.0.0']
    restart: unless-stopped
